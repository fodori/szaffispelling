<html>
  <head>
    <title>Szaffi spelling app</title>
    <script>
      var myStorage = window.localStorage;
      var wordsArray = JSON.parse(myStorage.getItem("wordsArray"));

      var origWords = [
          { word: "about", sentence: "I love thinking about the future.", score: 0, lesson: "2 I" },
          { word: "after", sentence: "He has come after me.", score: 0, lesson: "2 I" },
          { word: "again", sentence: "She fell asleep again when he left the room.", score: 0, lesson: "2 I" },
          { word: "also", sentence: "He was also dressed for the exclusive party.", score: 0, lesson: "2 I" },
          { word: "away", sentence: "Take that stuff away!", score: 0, lesson: "2 I" },
          { word: "back", sentence: "I'm going back home.", score: 0, lesson: "2 I" },
          { word: "because", sentence: "Because you are sorry for him!", score: 0, lesson: "2 I" },
          { word: "before", sentence: "Night came on before he had finished it.", score: 0, lesson: "2 I" },
          { word: "brother", sentence: "Her brother was a vamp.", score: 0, lesson: "2 I" },
          { word: "called", sentence: "I wish you had called me.", score: 0, lesson: "2 I" },
          { word: "cat", sentence: "The cat would like to eat the mouse.", score: 0, lesson: "2 I" },
          { word: "come", sentence: "I can come back.", score: 0, lesson: "2 I" },
          { word: "could", sentence: "How could he find out?", score: 0, lesson: "2 I" },
          { word: "day", sentence: "It is the day of the Lord.", score: 0, lesson: "2 I" },
          { word: "dog", sentence: "Does a dog have ears?", score: 0, lesson: "2 I" },
          { word: "down", sentence: "They sat down at the table.", score: 0, lesson: "2 I" },
          { word: "find", sentence: "The enemy will find it out.", score: 0, lesson: "2 I" },
          { word: "first", sentence: "It was the first money", score: 0, lesson: "2 I" },
          { word: "from", sentence: "He leaped from his horse.", score: 0, lesson: "2 I" },
          { word: "funny", sentence: "He's acting funny today.", score: 0, lesson: "2 I" },
          { word: "get", sentence: "Let's get the kids ready to go.", score: 0, lesson: "2 I" },
          { word: "going", sentence: "He was going to call the doctor.", score: 0, lesson: "2 I" },
          { word: "good", sentence: "You have a good family.", score: 0, lesson: "2 I" },
          { word: "got", sentence: "I just got a call from the doctor.", score: 0, lesson: "2 I" },
          { word: "had", sentence: "She had a choice.", score: 0, lesson: "2 I" },
          { word: "half", sentence: "I was awake half the night.", score: 0, lesson: "2 I" },

          { word: "have", sentence: "You'll all have to walk.", score: 0, lesson: "2 II" },
          { word: "high", sentence: "Her instincts on high alarm", score: 0, lesson: "2 II" },
          { word: "him", sentence: "I'm not like him", score: 0, lesson: "2 II" },
          { word: "house", sentence: "A house without children is not a home.", score: 0, lesson: "2 II" },
          { word: "how", sentence: "How beautiful it is!", score: 0, lesson: "2 II" },
          { word: "into", sentence: "Alex tossed her into the air.", score: 0, lesson: "2 II" },
          { word: "jump", sentence: "Bison can jump six feet high.", score: 0, lesson: "2 II" },
          { word: "just", sentence: "I just did it.", score: 0, lesson: "2 II" },
          { word: "keep", sentence: "Keep to the left!", score: 0, lesson: "2 II" },
          { word: "kind", sentence: "The years had not been kind to him.", score: 0, lesson: "2 II" },
          { word: "like", sentence: "The people did not like this.", score: 0, lesson: "2 II" },
          { word: "little", sentence: "The little man shook his bald head.", score: 0, lesson: "2 II" },
          { word: "live", sentence: "I live with my mother and daughter.", score: 0, lesson: "2 II" },
          { word: "long", sentence: "And I will be for a very long time.", score: 0, lesson: "2 II" },
          { word: "look", sentence: "Do I look that bad?", score: 0, lesson: "2 II" },
          { word: "low", sentence: "His voice was low and husky.", score: 0, lesson: "2 II" },
          { word: "made", sentence: "Katie made a face.", score: 0, lesson: "2 II" },
          { word: "make", sentence: "That does make sense.", score: 0, lesson: "2 II" },
          { word: "many", sentence: "You ask too many questions.", score: 0, lesson: "2 II" },
          { word: "may", sentence: "May we come in?", score: 0, lesson: "2 II" },
          { word: "more", sentence: "Think no more about it, he said.", score: 0, lesson: "2 II" },
          { word: "much", sentence: "How much is it, Dad?", score: 0, lesson: "2 II" },
          { word: "name", sentence: "Her name is Allie.", score: 0, lesson: "2 II" },

          { word: "new", sentence: "Is it something new for the trip?", score: 0, lesson: "2 III" },
          { word: "next", sentence: "The kids are in the next room.", score: 0, lesson: "2 III" },
          { word: "night", sentence: "That night... was Dad's birthday.", score: 0, lesson: "2 III" },
          { word: "not", sentence: "I am not saying we live in a utopia.", score: 0, lesson: "2 III" },
          { word: "now", sentence: "Now go home and get some rest.", score: 0, lesson: "2 III" },
          { word: "off", sentence: "I'll send it off to find out.", score: 0, lesson: "2 III" },
          { word: "once", sentence: "Once again she sighed deeply.", score: 0, lesson: "2 III" },
          { word: "other", sentence: "In other words, it's none of my business.", score: 0, lesson: "2 III" },
          { word: "our", sentence: "We are already well on our way.", score: 0, lesson: "2 III" },
          { word: "out", sentence: "Carmen held out a hand.", score: 0, lesson: "2 III" },
          { word: "over", sentence: "He is famous all over the world.", score: 0, lesson: "2 III" },
          { word: "people", sentence: "People on top of the earth are all meat.", score: 0, lesson: "2 III" },
          { word: "pick", sentence: "I'll soon pick it up.", score: 0, lesson: "2 III" },
          { word: "play", sentence: "Want to play a game?", score: 0, lesson: "2 III" },
          { word: "right", sentence: "Still, he had the right to know.", score: 0, lesson: "2 III" },
          { word: "said", sentence: "She said something and then rode ahead.", score: 0, lesson: "2 III" },
          { word: "saw", sentence: "The wolf saw him.", score: 0, lesson: "2 III" },
          { word: "seen", sentence: "No, I think I've seen enough.", score: 0, lesson: "2 III" },
          { word: "should", sentence: "It should be ready now.", score: 0, lesson: "2 III" },
          { word: "sister", sentence: "My sister is coming to visit.", score: 0, lesson: "2 III" },
          { word: "take", sentence: "I can take care of myself.", score: 0, lesson: "2 III" },
          { word: "thank", sentence: "Thank you for inviting us.", score: 0, lesson: "2 III" },
          { word: "that", sentence: "Well, if my cooking is that bad...", score: 0, lesson: "2 III" },
          { word: "their", sentence: "Why don't you put her on the bed in their room?", score: 0, lesson: "2 III" },
          { word: "them", sentence: "We'll take care of them together.", score: 0, lesson: "2 III" },
          
          { word: "then", sentence: "Then he picked up another box.", score: 0, lesson: "2 IV" },
          { word: "these", sentence: "How long would these mind games go on?", score: 0, lesson: "2 IV" },
          { word: "they", sentence: "They can actually talk!", score: 0, lesson: "2 IV" },
          { word: "thing", sentence: "It was a foolish thing to say.", score: 0, lesson: "2 IV" },
          { word: "took", sentence: "What took you so long?", score: 0, lesson: "2 IV" },
          { word: "tree", sentence: "Who made tree grow in house?", score: 0, lesson: "2 IV" },
          { word: "use", sentence: "I could use the help.", score: 0, lesson: "2 IV" },
          { word: "very", sentence: "You love him very much.", score: 0, lesson: "2 IV" },
          { word: "walk", sentence: "My sister can walk and run.", score: 0, lesson: "2 IV" },
          { word: "want", sentence: "I do not want all this.", score: 0, lesson: "2 IV" },
          { word: "was", sentence: "His voice was controlled.", score: 0, lesson: "2 IV" },
          { word: "wather", sentence: "I'm surprised to say the weather was better.", score: 0, lesson: "2 IV" },
          { word: "went", sentence: "I went along with it.", score: 0, lesson: "2 IV" },
          { word: "where", sentence: "Where are you? he asked.", score: 0, lesson: "2 IV" },
          { word: "which", sentence: "All of which was beside the point.", score: 0, lesson: "2 IV" },
          { word: "who", sentence: "Who had handed it to her?", score: 0, lesson: "2 IV" },
          { word: "with", sentence: "She came to the airport with him.", score: 0, lesson: "2 IV" },
          { word: "work", sentence: "It did work this morning.", score: 0, lesson: "2 IV" },
          { word: "would", sentence: "That would be the best way.", score: 0, lesson: "2 IV" },
          { word: "write", sentence: "Let him write the truth.", score: 0, lesson: "2 IV" },
          { word: "yes", sentence: "Yes, but I don't have time.", score: 0, lesson: "2 IV" },
          { word: "you", sentence: "I love you so much.", score: 0, lesson: "2 IV" },
          { word: "your", sentence: "What is your father's name?", score: 0, lesson: "2 IV" },

          { word: "accident", sentence: "A car accident", score: 0, lesson: "3 I" },
          { word: "accidentally", sentence: "the girls who accidentally get hit by cars", score: 0, lesson: "3 I" },
          { word: "actual", sentence: "Without the actual bones", score: 0, lesson: "3 I" },
          { word: "actually", sentence: "Her eyes actually were filled with tears.", score: 0, lesson: "3 I" },
          { word: "address", sentence: "My email address is in there, too.", score: 0, lesson: "3 I" },
          { word: "answer", sentence: "He put her answer down in his note book.", score: 0, lesson: "3 I" },
          { word: "appear", sentence: "They didn't appear to be moving quickly.", score: 0, lesson: "3 I" },
          { word: "arrive", sentence: "We expect visitors to arrive soon.", score: 0, lesson: "3 I" },
          { word: "believe", sentence: "I don't believe that.", score: 0, lesson: "3 I" },
          { word: "bicycle", sentence: "for riding a bicycle", score: 0, lesson: "3 I" },
          { word: "breath", sentence: "His breath smelled of liquor.", score: 0, lesson: "3 I" },
          { word: "breathe", sentence: "Rissa forced herself to breathe steadily.", score: 0, lesson: "3 I" },
          { word: "build", sentence: "He paused, to build the suspense.", score: 0, lesson: "3 I" },
          { word: "busy", sentence: "It's a large and busy hotel.", score: 0, lesson: "3 I" },
          { word: "business", sentence: "I mean, I could still have my business in town.", score: 0, lesson: "3 I" },
          { word: "calendar", sentence: "My calendar fills up quickly.", score: 0, lesson: "3 I" },
          { word: "caught", sentence: "You just happened to get caught on camera.", score: 0, lesson: "3 I" },
          { word: "centre", sentence: "The largest of these is situated in the centre of Cheduba island.", score: 0, lesson: "3 I" },
          { word: "century", sentence: "We're living in the 21st century, Mary.", score: 0, lesson: "3 I" },
          { word: "certain", sentence: "I feel certain of it.", score: 0, lesson: "3 I" },
          { word: "circle", sentence: "She drew a circle in the air.", score: 0, lesson: "3 I" },
          { word: "complete", sentence: "He has devised a complete explanation.", score: 0, lesson: "3 I" },
          { word: "consider", sentence: "Consider it a fact.", score: 0, lesson: "3 I" },
          { word: "continue", sentence: "He would continue until he was satisfied.", score: 0, lesson: "3 I" },

          { word: "decide", sentence: "I hope you decide to take the job.", score: 0, lesson: "3 II" },
          { word: "describe", sentence: "I can't describe how helpless I felt.", score: 0, lesson: "3 II" },
          { word: "different", sentence: "He's a different person, entirely.", score: 0, lesson: "3 II" },
          { word: "difficult", sentence: "It must be difficult for Alex to keep you happy.", score: 0, lesson: "3 II" },
          { word: "disappear", sentence: "They will simply disappear from daily use.", score: 0, lesson: "3 II" },
          { word: "early", sentence: "It's late and I have to get up early tomorrow.", score: 0, lesson: "3 II" },
          { word: "earth", sentence: "She hacked at the dry earth with her hoe.", score: 0, lesson: "3 II" },
          { word: "eight", sentence: "It was already nearing eight o'clock.", score: 0, lesson: "3 II" },
          { word: "eighth", sentence: "From Mohl down to the eighth decade ", score: 0, lesson: "3 II" },
          { word: "enough", sentence: "I've taken up enough of his time.", score: 0, lesson: "3 II" },
          { word: "exercise", sentence: "I see you're getting your exercise for the day.", score: 0, lesson: "3 II" },
          { word: "experience", sentence: "He has a lot of experience in these matters.", score: 0, lesson: "3 II" },
          { word: "experiment", sentence: "I shut down my experiment at six o'clock.", score: 0, lesson: "3 II" },
          { word: "extreme", sentence: "The situation called for extreme measures.", score: 0, lesson: "3 II" },
          { word: "famous", sentence: "It is still a famous school.", score: 0, lesson: "3 II" },
          { word: "favourite", sentence: "At first his favourite subject was classics.", score: 0, lesson: "3 II" },
          { word: "February", sentence: "On the 11th of February he died.", score: 0, lesson: "3 II" },
          { word: "forward", sentence: "She stepped forward and hugged him.", score: 0, lesson: "3 II" },
          { word: "fruit", sentence: "Beetroot for sugar, grain and fruit are also grown.", score: 0, lesson: "3 II" },
          { word: "grammar", sentence: "The grammar school was founded in 1618.", score: 0, lesson: "3 II" },
          { word: "group", sentence: "He stopped, watching a group of freight wagons.", score: 0, lesson: "3 II" },
          { word: "guard", sentence: "I heard you were a guard at Canon City.", score: 0, lesson: "3 II" },
          { word: "guide", sentence: "He will guide her when I am gone.", score: 0, lesson: "3 II" },
          { word: "heard", sentence: "I heard you scream.", score: 0, lesson: "3 II" },
          { word: "heart", sentence: "Her heart was starting to flutter.", score: 0, lesson: "3 II" },
          { word: "height", sentence: "The mountain ridges vary in height up to 4000 ft.", score: 0, lesson: "3 II" },

          { word: "history", sentence: "Is there some history I should know about?", score: 0, lesson: "3 III" },
          { word: "imagine", sentence: "Can you imagine that?", score: 0, lesson: "3 III" },
          { word: "increase", sentence: "That would increase the value of the house.", score: 0, lesson: "3 III" },
          { word: "important", sentence: "What's important is that you're alive.", score: 0, lesson: "3 III" },
          { word: "interest", sentence: "Somehow it failed to interest me.", score: 0, lesson: "3 III" },
          { word: "island", sentence: "He swam to an island that was not far away.", score: 0, lesson: "3 III" },
          { word: "knowledge", sentence: "We are becoming a knowledge economy.", score: 0, lesson: "3 III" },
          { word: "learn", sentence: "I have to learn to control myself.", score: 0, lesson: "3 III" },
          { word: "length", sentence: "His canines were four times the length of hers.", score: 0, lesson: "3 III" },
          { word: "library", sentence: "She left the library to return Damian's phone.", score: 0, lesson: "3 III" },
          { word: "material", sentence: "She had nothing material to report.", score: 0, lesson: "3 III" },
          { word: "medicine", sentence: "Medicine isn't an exact science.", score: 0, lesson: "3 III" },
          { word: "mention", sentence: "He didn't even mention her family.", score: 0, lesson: "3 III" },
          { word: "minute", sentence: "I need a minute to cool down.", score: 0, lesson: "3 III" },
          { word: "natural", sentence: "We think he might have some natural ability.", score: 0, lesson: "3 III" },
          { word: "naughty", sentence: "You are a very naughty witch.", score: 0, lesson: "3 III" },
          { word: "notice", sentence: "Others don't notice it, but I see it.", score: 0, lesson: "3 III" },
          { word: "occasion", sentence: "He was excited to see her dressed up for the occasion.", score: 0, lesson: "3 III" },
          { word: "occasionally", sentence: "Occasionally he would stand and bark.", score: 0, lesson: "3 III" },
          { word: "often", sentence: "Poor people are often sick.", score: 0, lesson: "3 III" },
          { word: "opposite", sentence: "They rode up the opposite hill.", score: 0, lesson: "3 III" },
          { word: "ordinary", sentence: "Alex was no ordinary man.", score: 0, lesson: "3 III" },
          { word: "particular", sentence: "The crowd seemed clustered at one particular spot.", score: 0, lesson: "3 III" },
          { word: "peculiar", sentence: "A peculiar kind of sugar called quercite exists in all acorns.", score: 0, lesson: "3 III" },
          { word: "perhaps", sentence: "Perhaps it was a foolish thing to do.", score: 0, lesson: "3 III" },

          { word: "popular", sentence: "You're certainly popular tonight.", score: 0, lesson: "3 IV" },
          { word: "position", sentence: "Han chuckled from his position near the window.", score: 0, lesson: "3 IV" },
          { word: "possession", sentence: "In the result nothing disturbed his peaceable possession of the see.", score: 0, lesson: "3 IV" },
          { word: "possess", sentence: "What truth would he possess?", score: 0, lesson: "3 IV" },
          { word: "possible", sentence: "I have only three possible answers.", score: 0, lesson: "3 IV" },
          { word: "potatoes", sentence: "The potatoes were ruined.", score: 0, lesson: "3 IV" },
          { word: "pressure", sentence: "Let me put pressure on it.", score: 0, lesson: "3 IV" },
          { word: "probably", sentence: "She was probably right.", score: 0, lesson: "3 IV" },
          { word: "promise", sentence: "I promise not to harm you.", score: 0, lesson: "3 IV" },
          { word: "purpose", sentence: "If you win or lose, let it be on purpose.", score: 0, lesson: "3 IV" },
          { word: "quarter", sentence: "He inhabited a separate quarter of the city.", score: 0, lesson: "3 IV" },
          { word: "question", sentence: "It wasn't a question, but a flat statement.", score: 0, lesson: "3 IV" },
          { word: "recent", sentence: "It was a recent decision.", score: 0, lesson: "3 IV" },
          { word: "regular", sentence: "For a long time I had no regular lessons.", score: 0, lesson: "3 IV" },
          { word: "reign", sentence: "We can no longer both reign together.", score: 0, lesson: "3 IV" },
          { word: "remember", sentence: "Do you remember that rumor in school?", score: 0, lesson: "3 IV" },
          { word: "sentence", sentence: "He typed a short sentence, and then stopped.", score: 0, lesson: "3 IV" },
          { word: "separate", sentence: "Absolutely. You are two separate people.", score: 0, lesson: "3 IV" },

          { word: "special", sentence: "It's nice to have that special respect.", score: 0, lesson: "3 V" },
          { word: "straight", sentence: "She looked him straight in the eye.", score: 0, lesson: "3 V" },
          { word: "strange", sentence: "Howard gave him a strange look.", score: 0, lesson: "3 V" },
          { word: "strength", sentence: "You've got to keep your strength up.", score: 0, lesson: "3 V" },
          { word: "suppose", sentence: "I don't suppose he'd agree.", score: 0, lesson: "3 V" },
          { word: "surprise", sentence: "He likes to surprise people.", score: 0, lesson: "3 V" },
          { word: "therefore", sentence: "And therefore, no one is with me.", score: 0, lesson: "3 V" },
          { word: "though", sentence: "She looked at them as though they had betrayed her.", score: 0, lesson: "3 V" },
          { word: "although", sentence: "Although she was exhausted, sleep didn't come.", score: 0, lesson: "3 V" },
          { word: "thought", sentence: "I never thought I could do it.", score: 0, lesson: "3 V" },
          { word: "through", sentence: "He ran a hand through his hair.", score: 0, lesson: "3 V" },
          { word: "various", sentence: "Response to the various greetings.", score: 0, lesson: "3 V" },
          { word: "weight", sentence: "Deidre let her full weight settle against him.", score: 0, lesson: "3 V" },
          { word: "woman", sentence: "The woman screamed piercingly.", score: 0, lesson: "3 V" },
          { word: "women", sentence: "Do you make many women cry?", score: 0, lesson: "3 V" },

          { word: "jolly", sentence: "He was a jolly man full of jokes.", score: 0, lesson: "4 I" },
          { word: "jolliest", sentence: "She is the jolliest in the class.", score: 0, lesson: "4 I" },
          { word: "happier", sentence: "She is happeir than yesterday", score: 0, lesson: "4 I" },
          { word: "beautiful", sentence: "Szaffi was soo beautiful", score: 0, lesson: "4 I" },
          { word: "everybody", sentence: "Everybody listen", score: 0, lesson: "4 I" },
          { word: "speaker", sentence: "This speaker is loud", score: 0, lesson: "4 I" },
          { word: "improve", sentence: "You need to improve your spellings", score: 0, lesson: "4 I" },
          { word: "should", sentence: "You should dress nicely in a restaurant", score: 0, lesson: "4 I" },
          { word: "says", sentence: "He says is a good idea", score: 0, lesson: "4 I" },
          { word: "your", sentence: "Is this pen is your one", score: 0, lesson: "4 I" },
          { word: "horrible", sentence: "This colour is horrible", score: 0, lesson: "4 I" },
          { word: "probably", sentence: "You should propably eat chocolate ice cream", score: 0, lesson: "4 I" },
          { word: "heel", sentence: "She turned on her heel and walked.", score: 0, lesson: "4 I" },
          { word: "heal", sentence: "I've gotta heal first.", score: 0, lesson: "4 I" },
          { word: "main", sentence: "His main sin appears to be his poor timing.", score: 0, lesson: "4 I" },
          { word: "mane", sentence: "The tiger has no mane", score: 0, lesson: "4 I" },
          { word: "medal", sentence: "A gold medal was awarded", score: 0, lesson: "4 I" },
          { word: "meddle", sentence: "He's very young to come to meddle with us.", score: 0, lesson: "4 I" },
          { word: "key", sentence: "He has a key to the mine gate.", score: 0, lesson: "4 I" },
          { word: "quay", sentence: "It has a fine quay, townhall and park.", score: 0, lesson: "4 I" },
          { word: "check", sentence: "Why not check it out?", score: 0, lesson: "4 I" },
          { word: "cheque", sentence: "No one else can use the gift cheque.", score: 0, lesson: "4 I" },

          { word: "actual", sentence: "Without the actual bones", score: 0, lesson: "4 II" },
          { word: "actually", sentence: "Her eyes actually were filled with tears.", score: 0, lesson: "4 II" },
          { word: "address", sentence: "My email address is in there, too.", score: 0, lesson: "4 II" },
          { word: "answer", sentence: "He put her answer down in his note book.", score: 0, lesson: "4 II" },
          { word: "calendar", sentence: "My calendar fills up quickly.", score: 0, lesson: "4 II" },
          { word: "disappear", sentence: "They will simply disappear from daily use.", score: 0, lesson: "4 II" },
          { word: "exercise", sentence: "I see you're getting your exercise for the day.", score: 0, lesson: "4 II" },
          { word: "experience", sentence: "He has a lot of experience in these matters.", score: 0, lesson: "4 II" },
          { word: "experiment", sentence: "I shut down my experiment at six o'clock.", score: 0, lesson: "4 II" },
          { word: "extreme", sentence: "The situation called for extreme measures.", score: 0, lesson: "4 II" },
          { word: "particular", sentence: "The crowd seemed clustered at one particular spot.", score: 0, lesson: "4 II" },
          { word: "peculiar", sentence: "A peculiar kind of sugar called quercite exists in all acorns.", score: 0, lesson: "4 II" },  
          { word: "though", sentence: "She looked at them as though they had betrayed her.", score: 0, lesson: "4 II" },
          { word: "although", sentence: "Although she was exhausted, sleep didn't come.", score: 0, lesson: "4 II" },
          { word: "thought", sentence: "I never thought I could do it.", score: 0, lesson: "4 II" },
          { word: "separate", sentence: "Absolutely. You are two separate people.", score: 0, lesson: "4 II" },
          { word: "difficult", sentence: "It must be difficult for Alex to keep you happy.", score: 0, lesson: "4 II" },
          { word: "disappear", sentence: "They will simply disappear from daily use.", score: 0, lesson: "4 II" },
        ];

      if (wordsArray === null || wordsArray === undefined) {
        myStorage.setItem("wordsArray", JSON.stringify(origWords));
        wordsArray = origWords;
      }
      var index = 0;
      var voices = null;
      var finished=[];

      function loadVoices() {
        voices = speechSynthesis.getVoices();
        voices.forEach(function (voice, i) {
          if (voice && voice.lang && voice.lang.includes('en') ){
            // Create a new option element.
            var option = document.createElement("option");

            // Set the options value and text.
            option.value = voice.name;
            option.innerHTML = `Voice name: ${voice.name} (${voice.lang})`;

            // Add the option to the voice selector.
            voiceSelect.appendChild(option);
          }
        });
        voiceSelect.value = myStorage.getItem("voiceSelect");
      }

      // Chrome loads voices asynchronously.
      speechSynthesis.onvoiceschanged = function (e) {
        loadVoices();
      };
      function speakWord(text) {
        if (voices === null) {
          loadVoices();
        }
        if (text){
          var speaker = new SpeechSynthesisUtterance();
          speaker.volume = parseFloat(1); //0--1
          speaker.rate = parseFloat(0.8); //0.1--10
          speaker.pitch = parseFloat(1.4); // 0--2
          speaker.lang = "en";
          speaker.text = text;

          //speaker.voice = voices[0];
          speaker.voice = speechSynthesis.getVoices().filter(function (voice) {
            return voice.name == voiceSelect.value;
          })[0];
          // voices.filter(function (voice) {
          //   return voice.name == "Daniel" || voice.name == "English United Kingdom";
          // })[0];
          // alert(speaker.voice);
          speechSynthesis.speak(speaker);
        }
      }
      function getTextFieldValue() {
        speakWord(document.getElementById("attemptword").value);
      }
      
      function getRandomIndex() {
        console.log(JSON.stringify(wordsArray))
        if (wordsArray.length===0){
          speakWord("No word left to learn today. Szaffi you are really good.");
          document.getElementById("controlpanel0").remove();
          document.getElementById("controlpanel1").remove();
          document.getElementById("controlpanel2").remove();
          return null;
        } 
        index = Math.floor(Math.random() * wordsArray.length);
        document.getElementById("attemptword").value = "";
        document.getElementById("attemptword").focus();
        helper.style.display = "none";
        refreshData();
      }
      function refreshData() {
        // var spanindex = document.getElementById("spanindex");
        // spanindex.textContent = index;
        // console.log(wordsArray[index]);
        helper.style.display = "none";
        if (wordsArray[index] && wordsArray[index].word){
          spanword.textContent = wordsArray[index].word;
          spansentence.textContent = wordsArray[index].sentence;
          spanscore.textContent = wordsArray[index].score;
        }
        myStorage.setItem("wordsArray", JSON.stringify(wordsArray));

      }
      function getSentence() {
        return wordsArray[index] && wordsArray[index].sentence;
      }
      function getWorld() {
        return wordsArray[index] && wordsArray[index].word;
      }

      function removeItem  (items, i) {
        return items.filter((item,index )=> index!==i)
      }

      function correct() {
        wordsArray[index].score++;
        refreshData();
        speakWord("correct");
        if (wordsArray[index].score>1){
          wordsArray=removeItem( wordsArray,index);
        console.log(JSON.stringify(wordsArray))
          speakWord("Congratulation, you learnt this word");
        }
      }

      function wrong() {
        wordsArray[index].score--;
        speakWord("wrong");
        helper.style.display = "block";
      }
      function checkWord() {
        var attemptword = document.getElementById("attemptword").value;
        if (!attemptword || attemptword.length === 0) {
          speakWord("type something into input field");
          return null;
        }
        checkBtn.disabled = true;
        if (`${attemptword}`.toLocaleLowerCase() === `${getWorld()}`.toLocaleLowerCase()) {
          correct(); 
          next();
        } else {
          wrong(); 
        }
      }

      var voiceSelect;
      var lessonSelect;

      function onChangeVoice(selectObject) {
        var value = selectObject.value;
        //console.log(value);

        myStorage.setItem("voiceSelect", value);
        myStorage.setItem("wordsArray", JSON.stringify(origWords));
        if (voiceSelect.value) {
          wordsArray = origWords.filter(i=> i.lesson ===voiceSelect.value );
        } else {
          wordsArray = origWords;
        }
        document.getElementById("lessonLength").innerHTML=wordsArray.length
      }
      function onChangeLesson(selectObject) {
        var value = selectObject.value;
        //console.log(value);
        myStorage.setItem("wordsArray", JSON.stringify(origWords));
        if (lessonSelect.value) {
          wordsArray = origWords.filter(i=> i.lesson ===lessonSelect.value );
        } else {
          wordsArray = origWords;
        }
        console.log('aaaa',wordsArray,lessonSelect.value)
        document.getElementById("lessonLength").innerHTML=wordsArray.length
        
      }
      function next(){
        checkBtn.disabled = false;
        getRandomIndex();
        speakWord(getSentence() ); 
        speakWord(getWorld() );
      }
      function init() {
        var spanword = document.getElementById("spanword");
        var spansentence = document.getElementById("spansentence");
        var spanscore = document.getElementById("spanscore");
        var helper = document.getElementById("helper");
        voiceSelect = document.getElementById("voice");
        lessonSelect = document.getElementById("lesson");
        var checkBtn = document.getElementById("checkBtn");

        if (voices === null) {
          loadVoices();
        }
        const uniqueLessons = new Set(origWords.map(function (item, i) {return item.lesson}));
        [...uniqueLessons].map(function (lesson, i) {
            // Create a new option element.
            var option = document.createElement("option");

            // Set the options value and text.
            option.value = lesson;
            option.innerHTML = `Lesson: ${lesson}`;

            // Add the option to the voice selector.
            lessonSelect.appendChild(option);
        });
      }
    </script>
  </head>
  <body style="font-family: Verdana, Geneva, Tahoma, sans-serif" onload="init()">
    <h1 style="text-align: center; color: rgb(90, 29, 160); font-size: 60px">Szaffi's Spelling book v0.16</h1>
    <!-- <h1 style="text-align: center; width: 100%">Order: <span id="spanindex"></span></h1> -->
    <div id="helper" style="display: none">
      <h1 style="text-align: center; width: 100%">Word: <span id="spanword"></span></h1>
      <h1 style="text-align: center; width: 100%">Sentence: <span id="spansentence"></span></h1>
    </div>
    <select name="voice" id="voice" onchange="onChangeVoice(this)">
      <option value="">-- select a voice --</option>
    </select>
    <select name="lesson" id="lesson" onchange="onChangeLesson(this)">
      <option value="">-- select a lesson --</option>
    </select>
    Words left to learn in this lession : <span id="lessonLength"></span>
    <p style="text-align: center" id="controlpanel0">
      <button onClick="next();" style="width: 200px; height: 100px; font-size: 30px">
        Next <span style="font-size: 30px; line-height: 15px">➤</span>
      </button>
      <button onClick="speakWord(getWorld() );" style="width: 200px; height: 100px; font-size: 30px">
        Replay <span style="font-size: 60px; line-height: 20px">↻</span>
      </button>
      <button onClick="speakWord(getSentence() );" style="width: 200px; height: 100px; font-size: 30px">
        Sentence <span style="font-size: 60px; line-height: 20px">˽</span>
      </button>
    </p>
    <h1 style="text-align: center; width: 100%" id="controlpanel1">Word Difficulty: <span id="spanscore"></span></h1>
    <div style="margin: 30px; text-align: center" id="controlpanel2">
      <button onClick="checkWord();" style="width: 400px; height: 100px; font-size: 30px" id="checkBtn">Check the word</button>
      <input type="text" id="attemptword" name="world" autofocus style="width: 100%; font-size: 60px" />
    </div>
  </body>
</html>
